////////////////////////////////////////////////////////////////////////////////
// FORM HANDLERS

Procedure OnOpen()

	Controls.Value.TypeRestriction = TypeRestriction;
	Controls.Value.Value = Controls.Value.TypeRestriction.AdjustValue(Value);
			
	If FillingMethod <> Enums.FieldFillingMethods.Value Then
		
		FormulaPresentation = Object.GetFormulaPresentation(New Structure("FillingMethod, Value",FillingMethod,Formula),TableBox);
		
	EndIf;	
	
	UpdateDialog();
	
EndProcedure

Procedure FormulaStartChoice(Control, StandardProcessing)

	Formula = Object.EditFormula(FillingMethod, Formula, FormulaPresentation, TableKind, TableName, TableBox, TypeRestriction, ThisForm);
	FormulaPresentation = Object.GetFormulaPresentation(New Structure("FillingMethod, Value",FillingMethod,Formula),TableBox);
	
EndProcedure

Procedure FormulaPresentationClearing(Control, StandardProcessing)
	
	Formula = "";
	
EndProcedure

Procedure FillingMethodOnChange(Control)

	Formula = "";
	FormulaPresentation = "";
	
	UpdateDialog();
	
EndProcedure // FillingMethodOnChange()

Procedure MainActionsButtonOK(Button)
	
	If NOT AcceptChanges() Then
		Return;
	EndIf;	
	
	Close(True);
	
EndProcedure

////////////////////////////////////////////////////////////////////////////////
// GENERAL PURPOSE PROCEDURES AND FUNCTIONS

Function AcceptChanges()
		
	Return True;
	
EndFunction	

Procedure UpdateDialog()
	
	If FillingMethod = Enums.FieldFillingMethods.Value Then
		
		Controls.PanelValueOrParameter.CurrentPage = Controls.PanelValueOrParameter.Pages.Value;
		
	Else
		
		Controls.FormulaPresentation.TextEdit = (FillingMethod = Enums.FieldFillingMethods.Value);
		Controls.PanelValueOrParameter.CurrentPage = Controls.PanelValueOrParameter.Pages.Formula;
		
	EndIf;	
	
EndProcedure	

